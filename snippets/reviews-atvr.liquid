<script>
  var productId = 'ATV-REAR'
  var bvURL = "https://api.bazaarvoice.com/data/reviews.json?apiversion=5.4&passkey=cadXfi6RaIIC4IZBzydqjxUM14WwFqTquPlBTv9hcK8r0&Filter=ProductId:"+ productId + "&Include=Products&Stats=Reviews#"
  var bvResults = {}
  var bvRequest = $.ajax({
    url: bvURL,
    type: "GET",
    success: function(data){
      bvPackageData(data)
     
    }
  });

  function bvPackageData(data) {
    var secondaryGroup = data.Includes.Products[productId].ReviewStatistics.SecondaryRatingsAverages;
    if (bvResults.AverageOverallRatings) {bvResults.AverageOverallRatings = data.Includes.Products[productId].ReviewStatistics.AverageOverallRating;};
    if (bvResults.EaseOfInstallation) {bvResults.EaseOfInstallation = secondaryGroup.EaseOfInstallation.AverageRating;};
    if (bvResults.Appearance) {bvResults.Appearance = secondaryGroup.Appearance.AverageRating;};
    if (bvResults.Versatillity) {bvResults.Versatillity = secondaryGroup.Versatillity.AverageRating;};
    if (bvResults.Durability) {bvResults.Durability = secondaryGroup.Durability.AverageRating;};
    if (bvResults.Value) {bvResults.Value = secondaryGroup.Durability.AverageRating;};
    
  function bvClass(value) {
    if (value >= 5.0) {
      return "five-zero"
    } else if (value >= 4.9) {
      return "four-nine"
    } else if (value >= 4.8) {
      return "four-eight"
    } else if (value >= 4.7) {
      return "four-seven"
    } else if (value >= 4.6) {
      return "four-six"
    } else if (value >= 4.5) {
      return "four-five"
    } else if (value >= 4.4) {
      return "four-four"
    } else if (value >= 4.3) {
      return "four-three"
    } else if (value >= 4.2) {
      return "four-two"
    } else if (value >= 4.1) {
      return "four-one"
    } else if (value >= 4.0) {
      return "four-zero"
    } else if (value >= 3.9) {
      return "three-nine"
    } else if (value >= 3.8) {
      return "three-eight"
    } else if (value >= 3.7) {
      return "three-seven"
    } else if (value >= 3.6) {
      return "three-six"
    } else if (value >= 3.5) {
      return "three-five"
    } else if (value >= 3.4) {
      return "three-four"
    } else if (value >= 3.3) {
      return "three-three"
    } else if (value >= 3.2) {
      return "three-two"
    } else if (value >= 3.1) {
      return "three-one"
    } else if (value >= 3.0) {
      return "three-zero"
    } else if (value >= 2.9) {
      return "two-nine"
    } else if (value >= 2.8) {
      return "two-eight"
    } else if (value >= 2.7) {
      return "two-seven"
    } else if (value >= 2.6) {
      return "two-six"
    } else if (value >= 2.5) {
      return "two-five"
    } else if (value >= 2.4) {
      return "two-four"
    } else if (value >= 2.3) {
      return "two-three"
    } else if (value >= 2.2) {
      return "two-two"
    } else if (value >= 2.1) {
      return "two-one"
    } else if (value >= 2.0) {
      return "two-zero"
    } else if (value >= 1.9) {
      return "one-nine"
    } else if (value >= 1.8) {
      return "one-eight"
    } else if (value >= 1.7) {
      return "one-seven"
    } else if (value >= 1.6) {
      return "one-six"
    } else if (value >= 1.5) {
      return "one-five"
    } else if (value >= 1.4) {
      return "one-four"
    } else if (value >= 1.3) {
      return "one-three"
    } else if (value >= 1.2) {
      return "one-two"
    } else if (value >= 1.1) {
      return "one-one"
    } else if (value >= 1.0) {
      return "one-zero"
    } else if (value >= 0.9) {
      return "zero-nine"
    } else if (value >= 0.8) {
      return "zero-eight"
    } else if (value >= 0.7) {
      return "zero-seven"
    } else if (value >= 0.6) {
      return "zero-six"
    } else if (value >= 0.5) {
      return "zero-five"
    } else if (value >= 0.4) {
      return "zero-four"
    } else if (value >= 0.3) {
      return "zero-three"
    } else if (value >= 0.2) {
      return "zero-two"
    } else if (value >= 0.1) {
      return "zero-one"
    }
  }

    $('.overall-average .rating').html(bvResults.AverageOverallRatings.toFixed(1))
    $('.overall-average .stars').addClass(bvClass(bvResults.AverageOverallRatings.toFixed(1)))


    $('.ease-of-installation .rating').html(bvResults.EaseOfInstallation.toFixed(1))
    $('.ease-of-installation .stars').addClass(bvClass(bvResults.EaseOfInstallation.toFixed(1)))

    $('.appearance .rating').html(bvResults.Appearance.toFixed(1))
    $('.appearance .stars').addClass(bvClass(bvResults.Appearance.toFixed(1)))

    $('.versatillity .rating').html(bvResults.Versatillity.toFixed(1))
    $('.versatillity .stars').addClass(bvClass(bvResults.Versatillity.toFixed(1)))

    $('.durability .rating').html(bvResults.Durability.toFixed(1))
    $('.durability .stars').addClass(bvClass(bvResults.Durability.toFixed(1)))

    $('.value .rating').html(bvResults.Value.toFixed(1))
    $('.value .stars').addClass(bvClass(bvResults.Value.toFixed(1)))
  } 
</script>
<div id="rr-snapshot-container">
  <section id="rr-snapshot">
    <div class="rr-summary">
      <h1>Ratings &amp; Reviews</h1>
      <a class="btn" onclick="$BV.ui('rr', 'submit_review', { 'productId' : productId });">Write a Review</a>
      <table class="rr-table">
        <tr>
          <td class="snapshot-rating-label" id="overall">Average Overall Rating</td>
          <td class="snapshot-rating overall-average"><span class="stars"></span> <span class="rating"></span></td>
        </tr>
        <tr>
          <td class="snapshot-rating-label">Ease of Installation</td>
          <td class="snapshot-rating ease-of-installation"><span class="stars"></span> <span class="rating"></span></td>
        </tr>
        <tr>
          <td class="snapshot-rating-label">Appearance</td>
          <td class="snapshot-rating appearance"><span class="stars"></span> <span class="rating"></span></td>
        </tr>
        <tr>
          <td class="snapshot-rating-label">Versatility</td>
          <td class="snapshot-rating versatillity"><span class="stars"></span> <span class="rating"></span></td>
        </tr>
        <tr>
          <td class="snapshot-rating-label">Durability</td>
          <td class="snapshot-rating durability"><span class="stars"></span> <span class="rating"></span></td>
        </tr>
        <tr>
          <td class="snapshot-rating-label">Value</td>
          <td class="snapshot-rating value"><span class="stars"></span> <span class="rating"></span></td>
        </tr>
      </table>
    </div>
    <div id="rr-excerpts">
      <h2>Review Highlights</h2>
      <figure class="rr-snapshot-quote">
        <blockquote>
          <p>Super rugged, well thought out, and easy to install&hellip;and it looks sick on my truck. Well worth the money!</p>
        </blockquote>
        <figcaption>Chris from Ohio</figcaption>
      </figure>
      <figure class="rr-snapshot-quote">
        <blockquote>
          <p>Strength, toughness, quality are just a few of the words of praise. To me, it&rsquo;s a good investment!</p>
        </blockquote>
        <figcaption>Duke from Utah</figcaption>
      </figure>
    </div>
  </section>
  <div class="clr"></div>
</div>
<div id="BVRRContainer"></div>
<script type="text/javascript">
   $BV.ui( 'rr', 'show_reviews', {
      doShowContent : function () { 
         // If the container is hidden (such as behind a tab), put code here to make it visible 
         //(open the tab).
      }
   });
</script>